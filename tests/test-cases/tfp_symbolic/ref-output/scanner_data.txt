== TFPs ==
../../test-queries/scanner-tfp/aliases.sql
+-----------+----------+---------+
|    pc     | aliasing | aliases |
+-----------+----------+---------+
| 0x400000a | []       | []      |
| 0x400000c | []       | []      |
+-----------+----------+---------+

../../test-queries/scanner-tfp/controllability.sql
+-----------+------------+----------------+-------------------------------------------------------------------------------------------+
|    pc     | controlled |  uncontrolled  |                                        unmodified                                         |
+-----------+------------+----------------+-------------------------------------------------------------------------------------------+
| 0x400000a | []         | ['rbp', 'rsp'] | ['rbx', 'rcx', 'rdx', 'rsi', 'rdi', 'r8', 'r9', 'r10', 'r11', 'r12', 'r13', 'r14', 'r15'] |
| 0x400000c | []         | ['rbp', 'rsp'] | ['rbx', 'rcx', 'rdx', 'rsi', 'rdi', 'r8', 'r9', 'r10', 'r11', 'r12', 'r13', 'r14', 'r15'] |
+-----------+------------+----------------+-------------------------------------------------------------------------------------------+

../../test-queries/scanner-tfp/main_fields.sql
+-----------+--------------+-----------+-----+-------------------------------------+---------+-------------------+------------+--------------------+----------------------+
|    pc     |     name     |  address  | reg |                expr                 | n_instr | n_dependent_loads | n_branches | contains_spec_stop |         bbls         |
+-----------+--------------+-----------+-----+-------------------------------------+---------+-------------------+------------+--------------------+----------------------+
| 0x400000a | tfp_symbolic | 0x4000000 | rax | <BV64 LOAD_64[<BV64 rcx + rsi>]_20> | 4       | 1                 | 1          | False              | [67108864, 67108874] |
| 0x400000c | tfp_symbolic | 0x4000000 | rax | <BV64 LOAD_64[<BV64 rcx + rsi>]_20> | 4       | 1                 | 1          | False              | [67108864, 67108876] |
+-----------+--------------+-----------+-----+-------------------------------------+---------+-------------------+------------+--------------------+----------------------+

../../test-queries/scanner-tfp/registers.sql
+-----------+---------+-------------------------------------+----------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rax_reg |              rax_expr               |              rax_control               | rax_branches | rax_constraints |                                                                        rax_requirements                                                                        | rax_range |
+-----------+---------+-------------------------------------+----------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rax     | <BV64 LOAD_64[<BV64 rcx + rsi>]_20> | TFPRegisterControlType.IS_TFP_REGISTER | []           | []              | {'regs': ['<BV64 rcx>', '<BV64 rsi>'], 'indirect_regs': ['<BV64 rcx>: []', '<BV64 rsi>: []'], 'direct_regs': [], 'mem': ['<BV64 rcx + rsi>'], 'const_mem': []} |           |
| 0x400000c | rax     | <BV64 LOAD_64[<BV64 rcx + rsi>]_20> | TFPRegisterControlType.IS_TFP_REGISTER | []           | []              | {'regs': ['<BV64 rcx>', '<BV64 rsi>'], 'indirect_regs': ['<BV64 rcx>: []', '<BV64 rsi>: []'], 'direct_regs': [], 'mem': ['<BV64 rcx + rsi>'], 'const_mem': []} |           |
+-----------+---------+-------------------------------------+----------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rbx_reg |  rbx_expr  |            rbx_control            | rbx_branches | rbx_constraints |                                             rbx_requirements                                             | rbx_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rbx     | <BV64 rbx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rbx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rbx>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rbx     | <BV64 rbx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rbx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rbx>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rcx_reg |  rcx_expr  |            rcx_control            | rcx_branches | rcx_constraints |                                             rcx_requirements                                             | rcx_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rcx     | <BV64 rcx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rcx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rcx>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rcx     | <BV64 rcx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rcx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rcx>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rdx_reg |  rdx_expr  |            rdx_control            | rdx_branches | rdx_constraints |                                             rdx_requirements                                             | rdx_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rdx     | <BV64 rdx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rdx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rdx>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rdx     | <BV64 rdx> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rdx>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rdx>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rsi_reg |  rsi_expr  |            rsi_control            | rsi_branches | rsi_constraints |                                             rsi_requirements                                             | rsi_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rsi     | <BV64 rsi> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rsi>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rsi>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rsi     | <BV64 rsi> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rsi>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rsi>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rdi_reg |  rdi_expr  |            rdi_control            | rdi_branches | rdi_constraints |                                             rdi_requirements                                             | rdi_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rdi     | <BV64 rdi> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rdi>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rdi>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rdi     | <BV64 rdi> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 rdi>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rdi>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rbp_reg |  rbp_expr  |             rbp_control             | rbp_branches | rbp_constraints |                                             rbp_requirements                                             | rbp_range |
+-----------+---------+------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rbp     | <BV64 rbp> | TFPRegisterControlType.UNCONTROLLED | []           | []              | {'regs': ['<BV64 rbp>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rbp>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rbp     | <BV64 rbp> | TFPRegisterControlType.UNCONTROLLED | []           | []              | {'regs': ['<BV64 rbp>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rbp>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+---------------------------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | rsp_reg |            rsp_expr             |             rsp_control             | rsp_branches | rsp_constraints |                                             rsp_requirements                                             | rsp_range |
+-----------+---------+---------------------------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | rsp     | <BV64 rsp>                      | TFPRegisterControlType.UNCONTROLLED | []           | []              | {'regs': ['<BV64 rsp>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rsp>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | rsp     | <BV64 0xfffffffffffffff8 + rsp> | TFPRegisterControlType.UNCONTROLLED | []           | []              | {'regs': ['<BV64 rsp>'], 'indirect_regs': [], 'direct_regs': ['<BV64 rsp>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+---------------------------------+-------------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
|    pc     | r8_reg |  r8_expr  |            r8_control             | r8_branches | r8_constraints |                                            r8_requirements                                             | r8_range |
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
| 0x400000a | r8     | <BV64 r8> | TFPRegisterControlType.UNMODIFIED | []          | []             | {'regs': ['<BV64 r8>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r8>'], 'mem': [], 'const_mem': []} |          |
| 0x400000c | r8     | <BV64 r8> | TFPRegisterControlType.UNMODIFIED | []          | []             | {'regs': ['<BV64 r8>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r8>'], 'mem': [], 'const_mem': []} |          |
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
|    pc     | r9_reg |  r9_expr  |            r9_control             | r9_branches | r9_constraints |                                            r9_requirements                                             | r9_range |
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
| 0x400000a | r9     | <BV64 r9> | TFPRegisterControlType.UNMODIFIED | []          | []             | {'regs': ['<BV64 r9>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r9>'], 'mem': [], 'const_mem': []} |          |
| 0x400000c | r9     | <BV64 r9> | TFPRegisterControlType.UNMODIFIED | []          | []             | {'regs': ['<BV64 r9>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r9>'], 'mem': [], 'const_mem': []} |          |
+-----------+--------+-----------+-----------------------------------+-------------+----------------+--------------------------------------------------------------------------------------------------------+----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r10_reg |  r10_expr  |            r10_control            | r10_branches | r10_constraints |                                             r10_requirements                                             | r10_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r10     | <BV64 r10> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r10>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r10>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r10     | <BV64 r10> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r10>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r10>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r11_reg |  r11_expr  |            r11_control            | r11_branches | r11_constraints |                                             r11_requirements                                             | r11_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r11     | <BV64 r11> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r11>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r11>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r11     | <BV64 r11> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r11>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r11>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r12_reg |  r12_expr  |            r12_control            | r12_branches | r12_constraints |                                             r12_requirements                                             | r12_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r12     | <BV64 r12> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r12>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r12>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r12     | <BV64 r12> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r12>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r12>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r13_reg |  r13_expr  |            r13_control            | r13_branches | r13_constraints |                                             r13_requirements                                             | r13_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r13     | <BV64 r13> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r13>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r13>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r13     | <BV64 r13> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r13>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r13>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r14_reg |  r14_expr  |            r14_control            | r14_branches | r14_constraints |                                             r14_requirements                                             | r14_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r14     | <BV64 r14> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r14>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r14>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r14     | <BV64 r14> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r14>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r14>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
|    pc     | r15_reg |  r15_expr  |            r15_control            | r15_branches | r15_constraints |                                             r15_requirements                                             | r15_range |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+
| 0x400000a | r15     | <BV64 r15> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r15>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r15>'], 'mem': [], 'const_mem': []} |           |
| 0x400000c | r15     | <BV64 r15> | TFPRegisterControlType.UNMODIFIED | []           | []              | {'regs': ['<BV64 r15>'], 'indirect_regs': [], 'direct_regs': ['<BV64 r15>'], 'mem': [], 'const_mem': []} |           |
+-----------+---------+------------+-----------------------------------+--------------+-----------------+----------------------------------------------------------------------------------------------------------+-----------+

../../test-queries/scanner-tfp/requirements.sql
+-----------+-------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+
|    pc     | constraints |                                                                          requirements                                                                          |                    branches                     |
+-----------+-------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+
| 0x400000a | []          | {'regs': ['<BV64 rcx>', '<BV64 rsi>'], 'indirect_regs': ['<BV64 rcx>: []', '<BV64 rsi>: []'], 'direct_regs': [], 'mem': ['<BV64 rcx + rsi>'], 'const_mem': []} | [('0x4000008', <Bool r15 != 0x0>, 'Not Taken')] |
| 0x400000c | []          | {'regs': ['<BV64 rcx>', '<BV64 rsi>'], 'indirect_regs': ['<BV64 rcx>: []', '<BV64 rsi>: []'], 'direct_regs': [], 'mem': ['<BV64 rcx + rsi>'], 'const_mem': []} | [('0x4000008', <Bool r15 == 0x0>, 'Taken')]     |
+-----------+-------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------------------+

